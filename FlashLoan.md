# Flash Loans

`Flash Loan` - это инструмент, с помощью которого пользователи `DeFi` могут заимствовать большое количество цифровых активов без залога на определенный период времени. Займ без залога означает, что участники не должны предоставлять подтверждение дохода и других обязательств. Пользователь DeFi может занять и вернуть любую сумму денег с небольшими затратами, `не требуя залогового обязательства`. Кроме того, для сторон отсутствует `контрагентский риск`, так как этот процесс происходит за считанные секунды в рамках одной транзакции. Тем не менее, некоторые атаки на протоколы доказали, что Flash Loans связаны с некоторыми типами рисков. Флэш-кредиты могут быть полезными инструментами для устранения `транзакционных издержек`, `обмена залогами`, `использования возможностей арбитража`, `самоликвидации и спекуляций`.

## Особенности срочного кредита

Значение срочной ссуды проистекает из того факта, что она должна быть заимствованы и погашены в рамках одной транзакции блокчейна. Либо будут выполнены все шаги блокчейн-транзакции, либо не произойдет ни один из них. В сети `Ethereum` транзакции могут состоять из нескольких шагов, таких как отправка `ETH` для оплаты сборов за газ, отправка токена `ERC20` и взаимодействие со смарт-контрактом. Следовательно, пользователь может взаимодействовать с несколькими протоколами DeFi для выполнения нескольких действий в рамках одной транзакции, например, обменивать, обменивать и делать ставки на 3 разных протокола. Каждое действие увеличивает требуемую плату за газ. Таким образом, пользователи должны быть осторожны с количеством шагов для включения. Точно так же в `Flash Loans` пользователь занимает и возвращает средства в рамках одной транзакции. В обоих случаях, если действие не выполняется по такой причине, как нехватка средств, ни одно из действий не будет выполнено. Пользователи по-прежнему платят за газ за невыполненные контракты. `AAVE` был первым проектом, который сделал популярным `Flash Loans`. `AAVE` развернула смарт-контракты на основе `Ethereum` (теперь также доступны на Polygon), что позволяют пользователям 3занимать несколько токенов и возвращать сумму в рамках одной транзакции. Быстрые ссуды, приносящие прибыль пользователям, обычно сопровождаются Плата за 0.09% плюс начальная сумма. В случае `AAVE` эта плата делится между вкладчики и интеграторы. В случае, если не все действия смарт-контракта выполняются (например, сделка не приносит прибыли или заемщик не возвращает сумму), транзакция не выполняется. Таким образом, кредитор получает первоначальные средства.

## Сценарии использования срочной ссуды

Когда пользователи занимают средства через `Flash Launch`, они могут использовать эти средства для других действий `DeFi`, если они возвращают сумму в рамках той же транзакции. Эта возможность открывает ряд интересных вариантов использования.

#### Арбитражные

Наиболее распространенный вариант использования срочной ссуды - получение выгоды от арбитражные возможности. Предположим, что цена 1 ETH составляет 1,000 `SWAP` на `DEX` A и 1,100 `SWAP` на `DEX` B.

1. Боб получает мгновенный заем в размере 10,000 XNUMX `SWAP` от AAVE.

2. Затем он покупает 10 `ETH` на `DEX` A и обменивает их на 11,000 `SWAP` на `DEX` B.

3. Боб выкупает ссуду в размере 10,000 0.09 `SWAP` (плюс комиссия 1,000%) и оставляет себе `XNUMX XNUMX SWAP`.

Если комиссия 0.09% плюс комиссия сети меньше 1,000 SWAP, Боб получит прибыль. Проскальзывание цен также является фактором, который следует учитывать для получения потенциальной прибыли. Он зависит от размера транзакции и доступной ликвидности в пуле. Возможности арбитража также часто используются ботами, которые могут обнаруживать и совершать аналогичную транзакцию с Бобом, но с более высокой комиссией за газ.

#### Обеспечение свопов

Сделано срочных кредитов залоговые свопы целесообразно для пользователей, желающих исключить высокие комиссии и множественные транзакции при обеспечении позиций. `MakerDAO` и Соединение - это протоколы кредитования `DeFi`, в которых пользователи, например, могут использовать `ETH` в качестве обеспечения для заимствования `DAI`. Но что, если Боб захочет обменять дополнительный токен, в данном случае `ETH`, на другой токен?

1. Он использует один из этих протоколов (скажем, `MakerDAO`) для заимствования DAI, но также хочет вернуть зарезервированный `ETH`.

2. Затем он использует `AAVE` для получения быстрой ссуды в `DAI`.

3. Боб погашает заемную сумму в `MakerDAO` с помощью недавно заимствованного `DAI`.

4. Теперь он может вывести свой `ETH` из `MakerDAO` и обменять его на SWAP на DEX.

5. Боб предоставляет `SWAP` в качестве обеспечения `MakerDAO` и занимает `DAI` для обеспечения своей первоначальной ссуды.

6. Наконец, он выплачивает срочный заем AAVE заемным `DAI` плюс комиссию в размере 0.09%.

`Все это… в одной транзакции! Своп обеспечения с ETH на SWAP с комиссией 0.09% от суммы займа.`

#### Самоликвидация

Кроме того, самоликвидация через `Flash Loans` — это способ для пользователей `DeFi` получить доступ к заблокированному залогу и избежать комиссий за ликвидацию. Подумайте о приведенном выше примере, когда Боб предоставил `ETH` в качестве залога для заимствования `DAI`. Если цена `ETH` снижается до уровня ликвидации, пользователи, как правило, предлагают больше `ETH`, чтобы повысить уровень ликвидации. Если контракт ликвидирует обеспечение Боба, Боб должен заплатить комиссию за ликвидацию. Предположим, что Боб не хочет поставлять `ETH` и у него недостаточно `DAI` для погашения кредита.

1. Боб получит флэш-ссуду на сумму, равную сумме `DAI`, которую он должен.

2. Затем он может погасить ссуду `DAI` и, таким образом, вывести токены `ETH`, которые он передал.

3. Посредством DEX Боб обменивает `ETH` на `DAI` и выплачивает флэш-ссуду. Он оставляет себе оставшийся `ETH`.

`Опять же… все шаги выполняются только в одной транзакции блокчейна. Либо все шаги, либо ни один из них не состоится. Срочные ссуды также были способом для трейдеров снизить комиссию за транзакцию и получить размышляющий по крипто-токенам.`

## Атаки DeFi через флэш-кредиты

`Атаки Flash Loan могут быть успешными, если злоумышленник может в определенной степени манипулировать рынком.`Эти атаки осуществляются посредством арбитража насосов и дампов и/или манипуляций с оракулами. Они дешевы в исполнении, поскольку злоумышленники не берут на себя денежных обязательств. Последняя атака Flash Loan произошла на Крем Финанс и вызвал убыток в размере 130 миллионов долларов. В 2021 году произошло еще несколько атак. Жетон кролика Атака произошла, когда злоумышленник использовал PancakeSwap для манипулирования рынком токена, что привело к снижению его цены на 95%. Злоумышленник занял BNB и манипулировал его ценой в отношении Bunny и USDT. Он купил большое количество Bunny и выбросил его на рынок, заработав около $ 3 миллионов. `Хакеры также использовали ApeRocket (1.26 миллиона долларов), AlphaHomora (37 миллионов долларов), BZx (1 миллион долларов) и другие проекты DeFi аналогичным образом.`
